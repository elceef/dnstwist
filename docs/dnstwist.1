." Manpage for dnstwist
.TH DNSTWIST 1 "2020-02-29" "" "User Commands"

.SH NAME
dnstwist - domain name permutation engine

.SH SYNOPSIS
.SY dnstwist
.OP \-a|\-\-all
.OP \-b|\-\-banners
.OP \-d|\-\-dictionary FILE
.OP \-f|\-\-format FORMAT
.OP \-g|\-\-geoip
.OP \-m|\-\-mxcheck
.OP \-r|\-\-registered
.OP \-s|\-\-ssdeep
.OP \-t|\-\-threads NUMBER
.OP \-w|\-\-whois
.OP \-\-nameservers LIST
.OP \-\-port NUMBER
.OP \-\-tld FILE
.OP \-\-useragent STRING
.I DOMAIN
.YS

.SH DESCRIPTION
Find similar-looking domain names that adversaries can use to attack you.
Detect typosquatters, phishing attacks, fraud and corporate espionage.
Useful as an additional source of targeted threat intelligence.

.SH OPTIONS
.TP
\fB\-a\fR, \fB\-\-all\fR
Show all DNS records.
.TP
\fB\-b\fR, \fB\-\-banners\fR
Determine HTTP and SMTP service banners.
.TP
\fB\-d\fR, \fB\-\-dictionary\fR \fIFILE\fR
Generate additional domains using a dictionary read from \fIFILE\fR.
.TP
\fB\-f\fR, \fB\-\-format\fR \fIFORMAT\fR
Select the output format. Supported values are: \fBcli\fR (default), \fBcsv\fR, \fBidle\fR, \fBjson\fR.
.TP
\fB\-g\fR, \fB\-\-geoip\fR
Perform lookup for GeoIP location.
.TP
\fB\-h\fR, \fB\-\-help\fR
Display a help message and exit.
.TP
\fB\-m\fR, \fB\-\-mxcheck\fR
Check if MX host can be used to intercept e-mails.
.TP
\fB\-r\fR, \fB\-\-registered\fR
Show only registered domain names.
.TP
\fB\-s\fR, \fB\-\-ssdeep\fR
Fetch web pages and compare their fuzzy hashes to evaluate similarity.
.TP
\fB\-t\fR, \fB\-\-threads\fR \fINUMBER\fR
Start specified \fINUMBER\fR of threads (default: 10).
.TP
\fB\-w\fR, \fB\-\-whois\fR
Perform lookup for WHOIS creation/update time (slow).
.TP
\fB\-\-nameservers\fR \fILIST\fR
Specify a comma-separated list of DNS servers to query.
.TP
\fB\-\-port\fR \fINUMBER\fR
Specify the port number to send queries to.
.TP
\fB\-\-tld\fR \fIFILE\fR
Generate additional domains by swapping TLD as read from \fIFILE\fR.
.TP
\fB\-\-useragent\fR \fISTRING\fR
User-agent to send with HTTP requests (default: \fBMozilla/5.0 dnstwist/20190706\fR).

.SH NOTES
The program will run the provided domain through its fuzzing algorithms and generate a list of
potential phishing domains with the following DNS records: A, AAAA, NS and MX.
The tool generates hundreds and thousands of domain names - especially for longer ones.
In such cases, it may be practical to display only registered (resolvable) ones using the \fB\-\-registered\fR argument.

.SS Fuzzy hashing
Manually checking each domain name in terms of serving a phishing site might be time consuming.
To address this, \fBdnstwist\fR makes use of so called fuzzy hashes (context triggered piecewise hashes).
Fuzzy hashing is a concept which involves the ability to compare two inputs
(in this case HTML code) and determine a fundamental level of similarity.
This unique feature of \fBdnstwist\fR can be enabled with \fB\-\-ssdeep\fR argument.
For each generated domain, \fBdnstwist\fR will fetch content from responding HTTP server (following possible redirects)
and compare its fuzzy hash with the one for the original (initial) domain.
The level of similarity will be expressed as a percentage.

Please keep in mind it's rather unlikely to get 100% match for a dynamically generated web page.
However, each notification should be inspected carefully regardless of the score.

In some cases phishing sites are served from a specific URL.
If you provide a full or partial URL address as an argument,
\fBdnstwist\fR will parse it and apply for each generated domain name variant.
This ability is obviously useful only in conjunction with the fuzzy hashing feature.

.SS MX checking
Very often attackers set up e-mail honey pots on phishing domains and wait for mistyped e-mails to arrive.
In this scenario, attackers would configure their server to vacuum up all e-mail addressed to that domain,
regardless of the user it was sent towards. Another \fBdnstwist\fR feature allows to perform a simple test
on each mail server (advertised through DNS MX record) in order to check which one can be used for such hostile intent.
Suspicious servers will be marked with the \fBSPYING-MX\fR string.

Please be aware of possible false positives.
Some mail servers only pretend to accept incorrectly addressed e-mails but then discard those messages.
This technique is used to prevent "directory harvesting attack".

.SS Coverage
Along with the length of the domain, the number of variants generated by the algorithms
increases considerably, and therefore the number of DNS queries needed to verify them.
For example, to check all variants for \fBgoogle.com\fR, you would have to send over 300k queries.
For the domain \fBfacebook.com\fR the number increases to over 5 million.
It is easy to guess it takes a lot of resources and, most importantly, even more time.
For longer domains, checking all options is simply not feasible.

For this reason, \fBdnstwist\fR generates and checks domains very close to the original one.
Theoretically, these are the most attractive domains from the attacker's point of view.
However, be aware that the imagination of the aggressors is unlimited.
